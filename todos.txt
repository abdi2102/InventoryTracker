// TODO: make code more concise, readable
